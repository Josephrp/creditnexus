Here is a comprehensive **Master Prompt** designed to be pasted directly into **Cursor** (or any AI IDE). It provides the context, architecture, tech stack, and specific coding tasks required to scaffold the **CreditNexus** platform.

---

# **Cursor Master Prompt: Project CreditNexus**

**Role:** You are a Senior Fintech Architect and Full-Stack Developer specializing in **FDC3 Interoperability**, **Unstructured Data Processing (RAG)**, and **React/Python** micro-services.

**Objective:** Kickstart the development of **"CreditNexus,"** a desktop-native syndicated loan management platform. This is a hackathon project that must demonstrate "Commercial Viability" and "Desktop Interoperability" using FDC3 standards.

The Architecture:

A monorepo containing:

1. **Client (Frontend):** A React `vite` application comprising three distinct "micro-apps" (simulated as separate routes/components for the hackathon) that communicate via the **FDC3** standard.
2. **Server (Backend):** A Python `FastAPI` service handling PDF parsing (OCR/LLM), trade workflow logic, and ESG verification.
3. **Data:** PostgreSQL (Structured Deal Data) and ChromaDB (Vector Embeddings for Documents).

---

## **1. Tech Stack & Standards**

- **Frontend:** React (TypeScript), Vite, TailwindCSS, `shadcn/ui` (for enterprise look), `@finos/fdc3` (for desktop interoperability).
- **Backend:** Python 3.11+, FastAPI, Pydantic, LangChain (for RAG), Unstructured.io (for PDF parsing).
- **Database:** PostgreSQL (via `sqlmodel`), ChromaDB.
- **Data Standard:** FINOS Common Domain Model (CDM) - simplified for the hackathon.

---

## **2. Directory Structure**

Please generate the file structure based on this schema:

/credit-nexus

/client (React Monorepo)

/src

/apps

/docu-digitizer  (App A: Drag-and-drop PDF parser)

/trade-blotter   (App B: Settlement workflow)

/green-lens      (App C: ESG dashboard)

/components        (Shared UI components)

/context           (FDC3 Context Definitions)

/server (Python API)

/app

/api               (Endpoints)

/core              (Config, CDM Models, Database)

/services          (LLM Service, Workflow Engine)

/shared                (Shared Types/JSON Schemas)

---

## **3. Implementation Steps (Execute these in order)**

### **Step 1: Define the Data Model (CDM)**

First, create a Pydantic model in `server/app/core/models.py` that represents a Syndicated Loan Facility based on the **FINOS Common Domain Model (CDM)**.

- **Fields:** `facility_name` (str), `borrower_lei` (str), `total_commitment` (float), `currency` (str), `margin_bps` (float), `maturity_date` (date), `governing_law` (enum: "English", "NY").
- **Key Feature:** Include a boolean field `sustainability_linked` and a nested object `esg_kpi_targets`.

### **Step 2: Define the FDC3 Context**

Create a TypeScript file `client/src/context/LoanContext.ts`.

- Standard FDC3 supports `fdc3.instrument`, but we need a custom context for loans.
- **Task:** Define a custom context interface `SyndicatedLoan` that extends the standard FDC3 context.
    - Type: `fdc3.creditnexus.loan`
    - ID slots: `LIN` (Loan ID Number), `DealID`.
    - Payload: Include the facility details from Step 1.

### **Step 3: Build the "Docu-Digitizer" Backend (RAG Pipeline)**

Create a FastAPI endpoint in `server/app/api/ingest.py` that accepts a PDF upload.

- **Logic:**
    1. Use `Unstructured` to chunk the PDF.
    2. Create a LangChain prompt to extract the **CDM Fields** (from Step 1) from the text.
    3. Return the structured JSON *and* save it to Postgres.
- **Prompt Instruction:** "Extract the Margin, Maturity Date, and Borrower Name from this credit agreement. Return ONLY valid JSON."

### **Step 4: Build the "Docu-Digitizer" Frontend**

Create a React component in `client/src/apps/docu-digitizer`.

- **UI:** A clean file upload zone.
- **Action:** When the API returns the JSON, display it in an editable form.
- **The "Magic" Moment:** Add a button labeled "Broadcast to Desktop". When clicked, use `window.fdc3.broadcast(context)` to send the `SyndicatedLoan` context to the other apps.

### **Step 5: Build the "Trade Blotter" (Listener)**

Create a React component `client/src/apps/trade-blotter`.

- **Logic:** Use `useEffect` to set up an FDC3 listener: `window.fdc3.addContextListener('fdc3.creditnexus.loan', handleContext)`.
- **UI:** When the context is received, *automatically* pre-fill a "LMA Trade Confirmation" ticket with the Borrower Name, Facility ID, and Pricing extracted in Step 3.
- **Commercial Logic:** Calculate the "Settlement Date" as `Today + 5 days` (beating the T+20 standard).

### **Step 6: Build "GreenLens" (The Margin Ratchet)**

Create a React component `client/src/apps/green-lens`.

- **Logic:** Listen for the same `SyndicatedLoan` context.
- **UI:** Display a chart (use `recharts`) comparing the Borrower's "Reported CO2" vs. "Target CO2".
- **Ratchet Logic:** If `Reported < Target`, display a badge: "Margin Discount Applied: -2.5 bps".

---

## **4. Specific Coding Instructions**

- **Mocking FDC3:** Since we might not be running inside a real OpenFin container during dev, please create a `useFDC3` hook that checks if `window.fdc3` exists. If not, log the broadcast to the console so we can debug in Chrome.
- **Styling:** Use `TailwindCSS` with a "Dark Mode" financial terminal aesthetic (slate grays, emerald greens for positive financial indicators).
- **Error Handling:** In the Python backend, ensure the LLM extraction fails gracefully if the PDF is illegible.

---

Action:

Please acknowledge this plan and start by generating the Project Skeleton (folder structure and package.json/requirements.txt files) and the CDM Pydantic Model.